export class DataGrid{constructor(e,t){const n=this,l=Object.extend({onClickEvent:null,showByPage:null},t),a={key:null,decs:!1},i=createEl("div","data-grid");let d=[];function r(){d=[],i.clear();const t=document.createElement("div");let n,l,a;t.className="data-grid-heading-row",i.append(t);for(let i=0;i<e.length;i++)n=e[i],l=document.createElement("div"),l.className="data-grid-heading-cell",t.appendChild(l),a=document.createElement("span"),a.id=n.key,a.innerHTML=n.label,l.appendChild(a),1==n.sorting&&(l.className+=" sorting",a.addEventListener("click",s))}function c(){null!=a.key&&d.sortOn(a.key,a.decs)}function o(){for(var e=0;e<d.length;e++)i.append(d[e].row)}function u(e,t,n){e.addEventListener("click",a=>{a.preventDefault(),l.onClickEvent.apply(e,[t,n[t],n])})}function s(e){e.preventDefault(),n.sortOn(e.target.id,!0)}n.container=i,n.addItem=function(t,r=!0){let o;if(null==t.id?t.id=String.uuid():o=n.getDataID(t.id),null!=o)!function(t,n){let l,a,i,d;for(let r=0;r<e.length;r++)l=e[r].key,null!=n[l]&&(a=n[l],t[l]=a,i=t.row.getElementsByClassName("data-grid-cell "+l)[0],d=i.getElementsByTagName("span")[0],!0!==e[r].image||null==n.image&&null==n[l+"_image"]||(a+='<img src="'+(n.image||n[l+"_image"])+'">'),d.innerHTML=a,!0===e[r].dataValue&&d.setAttribute("data-value",a))}(o,t);else if(t.row=function(t){const n=document.createElement("div");let a,d,r,c;n.id=t.id,n.className="data-grid-row";for(let i=0;i<e.length;i++)a=e[i].key,d=null!=t[a]?t[a]:"",r=document.createElement("div"),r.className="data-grid-cell "+a,n.appendChild(r),c=document.createElement("span"),r.appendChild(c),null!=t[a+"_id"]&&(c.id=t[a+"_id"]),!0!==e[i].image||null==t.image&&null==t[a+"_image"]||(d+='<img src="'+(t.image||t[a+"_image"])+'">'),c.innerHTML=d,!0===e[i].onClick&&null!=l.onClickEvent&&(c.className="link",u(c,a,t)),!0===e[i].dataValue&&c.setAttribute("data-value",d);return i.append(n),n}(t),d.push(t),r&&null!=a.key){c();for(let e=0;e<d.length;e++)if(d[e].id==t.id){null!=d[e+1]?i[0].insertBefore(t.row,d[e+1].row):i.append(t.row);break}}},n.addData=function(e,t=!1){for(let t=0;t<e.length;++t)n.addItem(e[t]);t&&(c(),o())},n.removeItem=function(e){let t,n;for(let l=0;l<d.length;l++)if(d[l].id==e){n=l,t=d[l];break}null!=t&&(i[0].removeChild(t.row),d.splice(n,1))},n.clear=function(){r()},n.size=function(){return d.length},n.getData=function(){return d},n.getDataID=function(e){for(let t=0;t<d.length;t++)if(d[t].id==e)return d[t];return null},n.sortOn=function(e,t=!1){!t||null!==a.key&&a.key!=e?(a.key=e,a.decs=!1):(a.key=e,a.decs=!a.decs);const n=i[0].getElementsByClassName("data-grid-heading-cell");let l,d;for(let e=0;e<n.length;e++)l=n[e].getElementsByTagName("span")[0],d="",l.getAttribute("id")==a.key&&(d=a.decs?"up":"down"),l.className=d;c(),o()},r()}}